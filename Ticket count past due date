WITH T1 AS (
    SELECT
        DISTINCT
        A.NUMBER
        ,A.SYS_CLASS_NAME
        ,A.SHORT_DESCRIPTION
        ,A.DESCRIPTION
        ,A.SYS_CREATED_ON
        ,A.DUE_DATE
        ,B.LABEL AS PRIORITY
    FROM
        TASK__VIEW A
    LEFT JOIN
        SYS_CHOICE__VIEW B
        ON TO_CHAR(A.PRIORITY) = B.VALUE AND B.ELEMENT = 'task_priority'
    WHERE
        A.ACTIVE = TRUE
)

SELECT
    YEAR(SYS_CREATED_ON) AS CREATED_YR
    ,MONTH(SYS_CREATED_ON) AS CREATED_MO
    ,SYS_CLASS_NAME
    ,COUNT(DISTINCT NUMBER) AS CT
FROM
    T1
WHERE
    CURRENT_DATE() > DUE_DATE
GROUP BY
    CREATED_YR
    ,CREATED_MO
    ,SYS_CLASS_NAME
ORDER BY
    CREATED_YR DESC
    ,CREATED_MO DESC
    ,CT DESC
;
